<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>è‡ªæ´½è®¡åˆ’-ç›å°¼å †</title>
    <style>
        body {
            background: #F5A3C7;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            position: relative;
        }

        /* èŠ±ç“£æ ·å¼ä¿æŒä¸å˜ */
        .petal { /* åŸæœ‰èŠ±ç“£æ ·å¼ */ }

        /* ç›å°¼å †å®¹å™¨ */
        #mani-stone {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -120%);
            z-index: 1;
            width: 600px;
            height: 400px;
        }

        .stone {
            position: absolute;
            width: 60px;
            height: 40px;
            clip-path: polygon(
                0 25%, 10% 0, 30% 10%, 45% 0,
                65% 15%, 85% 5%, 100% 25%,
                90% 60%, 70% 100%, 30% 90%, 0 70%
            );
            border-radius: 8px;
            box-shadow: 3px 3px 8px rgba(0,0,0,0.2);
            transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        /* æ–°å¢å‘é€æŒ‰é’®æ ·å¼ */
        .input-group {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        #send-btn {
            width: 80px;
            padding: 15px;
            background: #95C480;
            border: none;
            border-radius: 25px;
            color: white;
            cursor: pointer;
            transition: background 0.3s;
        }

        #send-btn:hover {
            background: #7DAF6D;
        }
    </style>
</head>
<body>
    <div id="mani-stone"></div>

    <div class="voice-ui">
        <button id="mic-btn">ğŸ¤</button>
        <h3 style="color:#636363;">è‡ªæˆ‘ç¥é¢‚</h3>
        <div class="input-group">
            <input type="text" id="text-input" placeholder="è¯´å‡ºæˆ–å†™ä¸‹æ‚¨çš„ç¥ç¦...">
            <button id="send-btn">å‘é€</button>
        </div>
    </div>

    <script>
        // ç‰©ç†å‚æ•°é…ç½®
        const MAX_LAYERS = 5;
        const STONES_PER_LAYER = [10, 8, 6, 4, 2];
        let currentLayer = 0;
        let stonesInLayer = 0;
        let lastColorIndex = -1;

        // æ‰©å±•é¢œè‰²åº“
        const STONE_COLORS = [
            '#A9A9A9', '#6D4C41', '#BCAAA4', 
            '#8D6E63', '#795548', '#A1887F',
            '#907B6E', '#6E5C54', '#857F7A'
        ];

        // ç”Ÿæˆä¸é‡å¤é¢œè‰²
        function getRandomColor() {
            let newIndex;
            do {
                newIndex = Math.floor(Math.random() * STONE_COLORS.length);
            } while (newIndex === lastColorIndex);
            lastColorIndex = newIndex;
            return STONE_COLORS[newIndex];
        }

        // çŸ³å—ç‰©ç†è¿åŠ¨
        function animateFall(stone) {
            const startX = parseInt(stone.style.left);
            const startY = parseInt(stone.style.top);
            const angle = Math.random() * 60 - 30;
            const distance = 300 + Math.random() * 200;
            
            stone.style.transition = 'all 1.2s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
            stone.style.transform = `
                rotate(${angle}deg)
                translate(${distance * Math.sign(angle)}px, 200px)
                scale(0.7)
            `;
            
            setTimeout(() => {
                stone.style.opacity = '0';
                setTimeout(() => stone.remove(), 1200);
            }, 100);
        }

        // ç”ŸæˆçŸ³å—
        function addStone(text) {
            if (!text) return;

            // æ£€æŸ¥å½“å‰å±‚å®¹é‡
            if (stonesInLayer >= STONES_PER_LAYER[currentLayer]) {
                animateFall(createStoneElement(text, true));
                return;
            }

            const stone = createStoneElement(text);
            positionStone(stone);
            document.getElementById('mani-stone').appendChild(stone);

            stonesInLayer++;
            if (stonesInLayer >= STONES_PER_LAYER[currentLayer]) {
                currentLayer = Math.min(currentLayer + 1, MAX_LAYERS - 1);
                stonesInLayer = 0;
            }
        }

        function createStoneElement(text, isFalling = false) {
            const stone = document.createElement('div');
            stone.className = 'stone';
            stone.style.background = getRandomColor();
            
            // æ–‡å­—å¤„ç†
            const stoneText = document.createElement('div');
            stoneText.className = 'stone-text';
            // ...ï¼ˆåŸæœ‰æ–‡å­—å¤„ç†é€»è¾‘ï¼‰

            if (isFalling) {
                stone.style.position = 'fixed';
                stone.style.left = `${50 + (Math.random() - 0.5) * 100}%`;
                stone.style.top = '20%';
            }

            return stone;
        }

        // ç²¾ç¡®è®¡ç®—çŸ³å—ä½ç½®
        function positionStone(stone) {
            const layerWidth = STONES_PER_LAYER[currentLayer] * 60;
            const xOffset = (600 - layerWidth) / 2 + stonesInLayer * 60;
            const yOffset = currentLayer * 40;

            stone.style.left = `${xOffset}px`;
            stone.style.top = `${yOffset}px`;
            stone.style.transform = `
                rotate(${Math.random() * 15 - 7.5}deg)
                scale(${0.9 + Math.random() * 0.2})
            `;
        }

        // äº‹ä»¶ç›‘å¬æ›´æ–°
        document.getElementById('send-btn').addEventListener('click', () => {
            const input = document.getElementById('text-input');
            if (input.value) {
                addStone(input.value);
                input.value = '';
            }
        });

        // å…¶ä»–åŸæœ‰é€»è¾‘...
    </script>
</body>
</html>